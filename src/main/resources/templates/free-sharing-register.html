<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- í˜ì´ì§€ ê¸°ë³¸ ì„¤ì • -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenCycle - ë¬´ë£Œë‚˜ëˆ” ë“±ë¡</title>
    
    <!-- CSS íŒŒì¼ ì—°ê²° - Thymeleaf ì •ì  ë¦¬ì†ŒìŠ¤ ê²½ë¡œ -->
    <link rel="stylesheet" th:href="@{/css/free-sharing-register.css}">
    
    <!-- êµ¬ê¸€ í°íŠ¸ ì—°ê²° -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” ë©”ë‰´ -->
    <header class="header">
        <nav class="navbar">
            <div class="nav-container">
                <!-- ë¡œê³  - Thymeleaf URL ì²˜ë¦¬ -->
                <a th:href="@{/}" class="logo">
                    <img th:src="@{/img/logo.png}" alt="GreenCycle ë¡œê³ " class="logo-img">
                </a>
                
                <!-- ë©”ë‰´ ëª©ë¡ -->
                <ul class="nav-menu">
                    <li><a th:href="@{/}">í™ˆ</a></li>
                    <li><a th:href="@{/#services}">ì„œë¹„ìŠ¤</a></li>
                    <li><a th:href="@{/waste-sorting}">ë¶„ë¦¬ë°°ì¶œ</a></li>
                    <li><a th:href="@{/free-sharing}" class="active">ë¬´ë£Œë‚˜ëˆ”</a></li>
                    <li><a th:href="@{/eco-market}">ì—ì½”ë§ˆì¼“</a></li>
                    <li><a th:href="@{/eco-talk}">í™˜ê²½ë…í†¡</a></li>
                    <li><a th:href="@{/notices}">ê³µì§€ì‚¬í•­</a></li>
                </ul>
                
                <!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… ë²„íŠ¼ - ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¥¸ ì¡°ê±´ë¶€ í‘œì‹œ -->
                <div class="auth-buttons">
                    <!-- ë¡œê·¸ì¸í•œ ê²½ìš° -->
                    <div th:if="${session.user}" class="user-menu">
                        <span th:text="${session.user.nickname + 'ë‹˜'}">ì‚¬ìš©ìë‹˜</span>
                        <a th:href="@{/logout}" class="btn-logout">ë¡œê·¸ì•„ì›ƒ</a>
                    </div>
                    <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœ (ì—ëŸ¬ ì¼€ì´ìŠ¤ - ë¡œê·¸ì¸ í•„ìš”) -->
                    <div th:unless="${session.user}" class="guest-menu">
                        <a th:href="@{/login}" class="btn-login">ë¡œê·¸ì¸</a>
                        <a th:href="@{/signup}" class="btn-signup">íšŒì›ê°€ì…</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- ë©”ì¸ ë‚´ìš© -->
    <main class="main-content">
        <!-- í˜„ì¬ ìœ„ì¹˜ í‘œì‹œ (ë¹µë¶€ìŠ¤ëŸ¬ê¸°) -->
        <section class="breadcrumb">
            <div class="container">
                <nav class="breadcrumb-nav">
                    <a th:href="@{/}">ğŸ </a> 
                    <span>></span> 
                    <a th:href="@{/free-sharing}">ë¬´ë£Œë‚˜ëˆ”</a> 
                    <span>></span> 
                    <span class="current">ë‚˜ëˆ” ë“±ë¡</span>
                </nav>
            </div>
        </section>

        <!-- í˜ì´ì§€ ì œëª© -->
        <section class="page-header">
            <div class="container">
                <h1 class="page-title">ğŸ¤ ë¬´ë£Œë‚˜ëˆ” ë“±ë¡</h1>
                <p class="page-subtitle">ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¬¼ê±´ì„ ì´ì›ƒê³¼ ë‚˜ëˆ„ë©° ìì› ìˆœí™˜ì„ ì‹¤í˜„í•´ë³´ì„¸ìš”</p>
            </div>
        </section>

        <!-- ë“±ë¡ í¼ -->
        <section class="registration-section">
            <div class="container">
                <!-- í¼ ì»¨í…Œì´ë„ˆ -->
                <div class="form-container">
                    <!-- í¼ í—¤ë” -->
                    <div class="form-header">
                        <h2>ë‚˜ëˆ” ë¬¼í’ˆ ë“±ë¡í•˜ê¸°</h2>
                        <p>ì •í™•í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì‹œë©´ ë” ë§ì€ ì´ì›ƒë“¤ì´ ê´€ì‹¬ì„ ê°€ì§ˆ ìˆ˜ ìˆì–´ìš”</p>
                    </div>

                    <!-- ì‹¤ì œ í¼ - Thymeleaf í¼ ê°ì²´ ë°”ì¸ë”© -->
                    <form class="form-body" id="registrationForm" 
                          th:action="@{/free-sharing/register}" 
                          th:object="${sharingForm}" 
                          method="post" 
                          enctype="multipart/form-data">
                        
                        <!-- ì œëª© ì…ë ¥ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ì œëª© <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <input type="text" 
                                       class="form-input" 
                                       th:field="*{title}"
                                       id="title" 
                                       placeholder="ë‚˜ëˆ”í•  ë¬¼í’ˆì˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" 
                                       required>
                                <!-- Thymeleaf ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜ ë©”ì‹œì§€ -->
                                <div class="error-message" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></div>
                                <div class="help-text">ë¬¼í’ˆëª…ê³¼ ìƒíƒœë¥¼ ê°„ë‹¨íˆ ì ì–´ì£¼ì„¸ìš” (ì˜ˆ: ì•„ì´ ì „ì§‘ (ìƒíƒœ ì¢‹ìŒ))</div>
                            </div>
                        </div>

                        <!-- ì‘ì„±ì (ìë™ ì…ë ¥) -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ì‘ì„±ì <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <input type="text" 
                                       class="form-input" 
                                       id="author" 
                                       th:value="${session.user.nickname}"
                                       readonly>
                                <!-- ìˆ¨ê²¨ì§„ í•„ë“œë¡œ ì‘ì„±ì ID ì „ì†¡ -->
                                <input type="hidden" th:field="*{authorId}" th:value="${session.user.id}">
                                <div class="help-text">ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ê°€ ìë™ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤</div>
                            </div>
                        </div>

                        <!-- ë“±ë¡ì¼ (ìë™ ì…ë ¥) -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ë“±ë¡ì¼</label>
                            </div>
                            <div class="form-input-section">
                                <input type="text" 
                                       class="form-input" 
                                       id="regDate" 
                                       th:value="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd HH:mm')}"
                                       readonly>
                            </div>
                        </div>

                        <!-- ìƒí’ˆ ìƒíƒœ ì„ íƒ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ìƒí’ˆìƒíƒœ <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <select class="form-select" th:field="*{condition}" id="condition" required>
                                    <option value="">ìƒíƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                    <option value="EXCELLENT">ìƒ (ë§¤ìš° ì¢‹ìŒ)</option>
                                    <option value="GOOD">ì¤‘ (ë³´í†µ)</option>
                                    <option value="FAIR">í•˜ (ì‚¬ìš©ê° ìˆìŒ)</option>
                                </select>
                                <div class="error-message" th:if="${#fields.hasErrors('condition')}" th:errors="*{condition}"></div>
                                <div class="help-text">ë¬¼í’ˆì˜ ì „ë°˜ì ì¸ ìƒíƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
                                <!-- ìƒí’ˆ ìƒíƒœ ë¯¸ë¦¬ë³´ê¸° (JavaScriptë¡œ ì œì–´) -->
                                <div class="condition-preview" id="conditionPreview"></div>
                            </div>
                        </div>

                        <!-- ì§€ì—­ ì„ íƒ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ì§€ì—­ <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <div class="form-group">
                                    <!-- ì‹œ/ë„ ì„ íƒ -->
                                    <select class="form-select" th:field="*{region1}" id="region1" required>
                                        <option value="">ì‹œ/ë„</option>
                                        <!-- ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ ì§€ì—­ ëª©ë¡ -->
                                        <option th:each="region : ${regions}" 
                                                th:value="${region.code}" 
                                                th:text="${region.name}">ì„œìš¸íŠ¹ë³„ì‹œ</option>
                                    </select>
                                    <!-- êµ¬/êµ° ì„ íƒ (JavaScriptë¡œ ë™ì  ë¡œë“œ) -->
                                    <select class="form-select" th:field="*{region2}" id="region2" required>
                                        <option value="">êµ¬/êµ°</option>
                                    </select>
                                </div>
                                <div class="error-message" th:if="${#fields.hasErrors('region1')}" th:errors="*{region1}"></div>
                                <div class="error-message" th:if="${#fields.hasErrors('region2')}" th:errors="*{region2}"></div>
                                <div class="help-text">ë‚˜ëˆ”ì„ ì§„í–‰í•  ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
                            </div>
                        </div>

                        <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ì¹´í…Œê³ ë¦¬ <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <select class="form-select" th:field="*{categoryId}" id="category" required>
                                    <option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                    <!-- ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¶œë ¥ -->
                                    <option th:each="category : ${categories}" 
                                            th:value="${category.id}" 
                                            th:text="${category.name}">ê°€êµ¬/ì¸í…Œë¦¬ì–´</option>
                                </select>
                                <div class="error-message" th:if="${#fields.hasErrors('categoryId')}" th:errors="*{categoryId}"></div>
                            </div>
                        </div>

                        <!-- ìƒí’ˆ ì„¤ëª… -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ìƒí’ˆì„¤ëª… <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <textarea class="form-input form-textarea" 
                                          th:field="*{description}"
                                          id="description" 
                                          placeholder="ë¬¼í’ˆì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì„ ì ì–´ì£¼ì„¸ìš”" 
                                          required></textarea>
                                <div class="error-message" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></div>
                                <div class="help-text">ë¬¼í’ˆì˜ ìƒíƒœ, ì‚¬ìš© ê¸°ê°„, íŠ¹ì´ì‚¬í•­ ë“±ì„ ìì„¸íˆ ì ì–´ì£¼ì‹œë©´ ì¢‹ì•„ìš”</div>
                            </div>
                        </div>

                        <!-- ê±°ë˜ ë°©ë²• ì„ íƒ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ê±°ë˜ ë°©ë²• <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <div class="trade-methods">
                                    <label class="checkbox-label">
                                        <input type="checkbox" th:field="*{tradeMethods}" value="DIRECT" id="directTrade">
                                        <span class="checkmark"></span>
                                        ì§ê±°ë˜
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" th:field="*{tradeMethods}" value="DELIVERY" id="deliveryTrade">
                                        <span class="checkmark"></span>
                                        íƒë°°ê±°ë˜
                                    </label>
                                </div>
                                <div class="error-message" th:if="${#fields.hasErrors('tradeMethods')}" th:errors="*{tradeMethods}"></div>
                                <div class="help-text">ê°€ëŠ¥í•œ ê±°ë˜ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”</div>
                            </div>
                        </div>

                        <!-- ì—°ë½ì²˜ ì •ë³´ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ì—°ë½ì²˜</label>
                            </div>
                            <div class="form-input-section">
                                <div class="contact-group">
                                    <div class="contact-item">
                                        <label>ì „í™”ë²ˆí˜¸</label>
                                        <input type="tel" th:field="*{phoneNumber}" placeholder="010-0000-0000">
                                    </div>
                                    <div class="contact-item">
                                        <label>ì¹´ì¹´ì˜¤í†¡ ID</label>
                                        <input type="text" th:field="*{kakaoId}" placeholder="ì¹´ì¹´ì˜¤í†¡ ID">
                                    </div>
                                </div>
                                <div class="help-text">ì—°ë½ ë°›ì„ ìˆ˜ ìˆëŠ” ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>
                            </div>
                        </div>

                        <!-- ì‚¬ì§„ ì—…ë¡œë“œ -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">ì‚¬ì§„ ì²¨ë¶€</label>
                            </div>
                            <div class="form-input-section">
                                <!-- ì‚¬ì§„ ì—…ë¡œë“œ ì˜ì—­ -->
                                <div class="image-upload-area" id="imageUploadArea" onclick="document.getElementById('imageInput').click()">
                                    <div class="upload-icon">ğŸ“·</div>
                                    <div class="upload-text">ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”</div>
                                    <div class="upload-hint">ìµœëŒ€ 5ê°œê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥ (JPG, PNG)</div>
                                </div>
                                <!-- ì‹¤ì œ íŒŒì¼ ì…ë ¥ -->
                                <input type="file" th:field="*{images}" id="imageInput" multiple accept="image/*" style="display: none;">
                                <div class="error-message" th:if="${#fields.hasErrors('images')}" th:errors="*{images}"></div>
                                <!-- ì—…ë¡œë“œëœ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸° (JavaScriptë¡œ ì œì–´) -->
                                <div class="image-preview" id="imagePreview"></div>
                                <div class="help-text">ë¬¼í’ˆ ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì‹œë©´ ë‚˜ëˆ” ì„±ê³µë¥ ì´ ë†’ì•„ì ¸ìš”</div>
                            </div>
                        </div>
                    </form>

                    <!-- í¼ ë²„íŠ¼ë“¤ -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-cancel" th:onclick="|location.href='@{/free-sharing}'|">ì·¨ì†Œ</button>
                        <button type="submit" class="btn btn-submit" form="registrationForm">ë“±ë¡í•˜ê¸°</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- í•˜ë‹¨ í‘¸í„° -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <!-- íšŒì‚¬ ì •ë³´ -->
                <div class="footer-section">
                    <div class="logo">
                        <span class="logo-icon">ğŸŒ±</span>
                        <span class="logo-text">GreenCycle</span>
                    </div>
                    <p>ì²¨ë‹¨ ê¸°ìˆ ë¡œ ì‹¤í˜„í•˜ëŠ” ìŠ¤ë§ˆíŠ¸í•˜ê³  ì§€ì† ê°€ëŠ¥í•œ í™˜ê²½ í”Œë«í¼</p>
                </div>
                
                <!-- ì„œë¹„ìŠ¤ ë§í¬ -->
                <div class="footer-section">
                    <h4>ì„œë¹„ìŠ¤</h4>
                    <ul>
                        <li><a th:href="@{/waste-sorting}">ìŠ¤ë§ˆíŠ¸ ë¶„ë¦¬ë°°ì¶œ</a></li>
                        <li><a th:href="@{/free-sharing}">ë¬´ë£Œë‚˜ëˆ”</a></li>
                        <li><a th:href="@{/eco-market}">ì—ì½”ë§ˆì¼“</a></li>
                        <li><a th:href="@{/eco-talk}">í™˜ê²½ë…í†¡</a></li>
                    </ul>
                </div>
                
                <!-- íšŒì‚¬ ì •ë³´ ë§í¬ -->
                <div class="footer-section">
                    <h4>íšŒì‚¬ì •ë³´</h4>
                    <ul>
                        <li><a th:href="@{/about}">íšŒì‚¬ì†Œê°œ</a></li>
                        <li><a th:href="@{/careers}">ì±„ìš©ì •ë³´</a></li>
                    </ul>
                </div>
                
                <!-- ê³ ê° ì§€ì› ë§í¬ -->
                <div class="footer-section">
                    <h4>ê³ ê°ì§€ì›</h4>
                    <ul>
                        <li><a th:href="@{/contact}">ë¬¸ì˜í•˜ê¸°</a></li>
                        <li><a th:href="@{/customer-service}">ê³ ê°ì„¼í„°</a></li>
                    </ul>
                </div>
            </div>
            
            <!-- ì €ì‘ê¶Œ ì •ë³´ -->
            <div class="footer-bottom">
                <p>&copy; 2025 GreenCycle. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript íŒŒì¼ ì—°ê²° - Thymeleaf ì •ì  ë¦¬ì†ŒìŠ¤ ê²½ë¡œ -->
    <script th:src="@{/js/free-sharing-register.js}"></script>
    
    <!-- í¼ ë°ì´í„°ë¥¼ JavaScriptë¡œ ì „ë‹¬ -->
    <script th:inline="javascript">
        // ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ ë°ì´í„°ë¥¼ JavaScript ë³€ìˆ˜ë¡œ ì„¤ì •
        var categoriesData = /*[[${categories}]]*/ [];
        var regionsData = /*[[${regions}]]*/ [];
        var currentUser = /*[[${session.user}]]*/ {};
        
        // ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •
        window.categoriesData = categoriesData;
        window.regionsData = regionsData;
        window.currentUser = currentUser;
        
        // ìƒí’ˆ ìƒíƒœ ì„ íƒì‹œ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
        document.getElementById('condition').addEventListener('change', function() {
            const conditionPreview = document.getElementById('conditionPreview');
            const selectedValue = this.value;
            
            if (selectedValue) {
                let conditionText = '';
                let stars = '';
                
                switch(selectedValue) {
                    case 'EXCELLENT':
                        conditionText = 'ë§¤ìš° ì¢‹ìŒ - ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•Šì•„ ìƒˆ ì œí’ˆê³¼ ê°™ì€ ìƒíƒœ';
                        stars = 'â­â­â­â­â­';
                        break;
                    case 'GOOD':
                        conditionText = 'ë³´í†µ - ì¼ë°˜ì ì¸ ì‚¬ìš©ê°ì´ ìˆì§€ë§Œ ê¸°ëŠ¥ìƒ ë¬¸ì œì—†ìŒ';
                        stars = 'â­â­â­';
                        break;
                    case 'FAIR':
                        conditionText = 'ì‚¬ìš©ê° ìˆìŒ - ì˜¤ë˜ ì‚¬ìš©í•˜ì—¬ í”ì ì´ ìˆì§€ë§Œ ì‚¬ìš© ê°€ëŠ¥';
                        stars = 'â­â­';
                        break;
                }
                
                conditionPreview.innerHTML = `
                    <div style="padding: 10px; background: #f5f5f5; border-radius: 5px; margin-top: 10px;">
                        <span style="font-size: 16px;">${stars}</span>
                        <span style="margin-left: 10px; color: #666;">${conditionText}</span>
                    </div>
                `;
            } else {
                conditionPreview.innerHTML = '';
            }
        });
        
        // ì§€ì—­ ì„ íƒ ë³€ê²½ì‹œ í•˜ìœ„ ì§€ì—­ ë¡œë“œ
        document.getElementById('region1').addEventListener('change', function() {
            const region2Select = document.getElementById('region2');
            const selectedRegion = this.value;
            
            // í•˜ìœ„ ì§€ì—­ ì´ˆê¸°í™”
            region2Select.innerHTML = '<option value="">êµ¬/êµ°</option>';
            
            if (selectedRegion) {
                // ì„œë²„ì—ì„œ í•˜ìœ„ ì§€ì—­ ë°ì´í„° ë¡œë“œ
                fetch(`/api/regions/${selectedRegion}/sub-regions`)
                .then(response => response.json())
                .then(subRegions => {
                    subRegions.forEach(subRegion => {
                        const option = document.createElement('option');
                        option.value = subRegion.code;
                        option.textContent = subRegion.name;
                        region2Select.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error loading sub-regions:', error);
                });
            }
        });
        
        // ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
        document.getElementById('imageInput').addEventListener('change', function(event) {
            const files = event.target.files;
            const imagePreview = document.getElementById('imagePreview');
            
            // ê¸°ì¡´ ë¯¸ë¦¬ë³´ê¸° ì´ˆê¸°í™”
            imagePreview.innerHTML = '';
            
            if (files.length > 5) {
                alert('ìµœëŒ€ 5ê°œì˜ ì´ë¯¸ì§€ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                this.value = '';
                return;
            }
            
            // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
            Array.from(files).forEach((file, index) => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageDiv = document.createElement('div');
                        imageDiv.className = 'preview-image';
                        imageDiv.innerHTML = `
                            <img src="${e.target.result}" alt="ë¯¸ë¦¬ë³´ê¸° ${index + 1}">
                            <button type="button" class="remove-image" onclick="removeImage(${index})">Ã—</button>
                        `;
                        imagePreview.appendChild(imageDiv);
                    };
                    reader.readAsDataURL(file);
                }
            });
        });
        
        // ì´ë¯¸ì§€ ì œê±° í•¨ìˆ˜
        function removeImage(index) {
            const imageInput = document.getElementById('imageInput');
            const dt = new DataTransfer();
            const files = Array.from(imageInput.files);
            
            files.splice(index, 1);
            files.forEach(file => dt.items.add(file));
            
            imageInput.files = dt.files;
            
            // ë¯¸ë¦¬ë³´ê¸° ë‹¤ì‹œ ìƒì„±
            const changeEvent = new Event('change', { bubbles: true });
            imageInput.dispatchEvent(changeEvent);
        }
    </script>
</body>
</html>