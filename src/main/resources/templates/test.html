<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenCycle 관리자 - 회원 관리</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ===================================
           CSS Variables - 색상 및 기본 설정
           =================================== */
        :root {
            /* 기본 색상 */
            --primary-color: #2ecc71;
            --secondary-color: #95a5a6;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #3498db;
            --success-color: #27ae60;
            --light-gray: #f8f9fa;
            --border-color: #ddd;
            --dark-gray: #2c3e50;
            --text-color: #333;
            --hover-color: #27ae60;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --modal-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);

            /* 권한별 색상 */
            --role-seedling: #8bc34a;      /* 새싹 - 연두색 */
            --role-regular: #2196f3;       /* 일반회원 - 파란색 */
            --role-excellent: #9c27b0;     /* 우수회원 - 보라색 */
            --role-vip: #ff9800;           /* VIP회원 - 골드색 */
            
            /* 상태별 색상 */
            --status-active: #27ae60;      /* 활성 - 녹색 */
            --status-inactive: #95a5a6;    /* 비활성 - 회색 */
            --status-suspended: #e74c3c;   /* 정지 - 빨간색 */
        }

        /* ===================================
           기본 리셋 및 폰트 설정
           =================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--light-gray);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* ===================================
           관리자 헤더 스타일
           =================================== */
        .admin-header {
            background: white;
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }

        .admin-navbar {
            padding: 0 20px;
        }

        .admin-nav-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
            height: 70px;
        }

        /* 관리자 로고 스타일 */
        .admin-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .logo-icon {
            font-size: 1.5rem;
        }

        .logo-text {
            color: var(--primary-color);
        }

        .admin-badge {
            background: var(--danger-color);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* 관리자 메뉴 스타일 */
        .admin-nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .admin-nav-menu a {
            text-decoration: none;
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: 6px;
            transition: all 0.2s;
            font-weight: 500;
        }

        .admin-nav-menu a:hover,
        .admin-nav-menu a.active {
            background: var(--primary-color);
            color: white;
        }

        /* 관리자 프로필 스타일 */
        .admin-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-name {
            font-weight: 500;
            color: var(--text-color);
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .logout-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        .logout-btn:hover {
            background: #7f8c8d;
        }

        /* ===================================
           메인 레이아웃 스타일
           =================================== */
        .admin-main {
            display: flex;
            margin-top: 70px;
            min-height: calc(100vh - 70px);
        }

        /* 사이드바 스타일 */
        .admin-sidebar {
            width: 250px;
            background: white;
            border-right: 1px solid var(--border-color);
            padding: 20px;
        }

        .sidebar-menu .menu-group h3 {
            color: var(--dark-gray);
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .sidebar-menu ul {
            list-style: none;
        }

        .sidebar-menu ul li {
            margin-bottom: 8px;
        }

        .sidebar-menu ul li a {
            display: block;
            padding: 12px 15px;
            text-decoration: none;
            color: var(--text-color);
            border-radius: 6px;
            transition: all 0.2s;
            font-weight: 500;
        }

        .sidebar-menu ul li a:hover,
        .sidebar-menu ul li a.active {
            background: var(--primary-color);
            color: white;
        }

        /* 메인 콘텐츠 영역 */
        .admin-content {
            flex: 1;
            padding: 30px;
            background: var(--light-gray);
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-header h1 {
            font-size: 2rem;
            font-weight: 600;
            color: var(--dark-gray);
        }

        /* ===================================
           통계 카드 스타일
           =================================== */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            border: 1px solid var(--border-color);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            font-size: 2.5rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light-gray);
            border-radius: 12px;
        }

        .stat-info {
            flex: 1;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-gray);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--secondary-color);
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .stat-change {
            font-size: 0.85rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 12px;
        }

        .stat-change.positive {
            background: rgba(46, 204, 113, 0.1);
            color: var(--success-color);
        }

        .stat-change.negative {
            background: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
        }

        /* ===================================
           검색 및 필터 스타일
           =================================== */
        .search-filter-section {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-box input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.1);
        }

        .search-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .search-btn:hover {
            background: var(--hover-color);
            transform: translateY(-1px);
        }

        .filter-options {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-options select {
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-size: 0.9rem;
            transition: border-color 0.2s;
        }

        .filter-options select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .filter-reset {
            color: var(--info-color);
            text-decoration: none;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .filter-reset:hover {
            background: rgba(52, 152, 219, 0.1);
        }

        /* ===================================
           테이블 스타일
           =================================== */
        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid var(--border-color);
            background: var(--light-gray);
        }

        .table-header h2 {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark-gray);
        }

        .table-controls select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: white;
            cursor: pointer;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .members-table {
            width: 100%;
            border-collapse: collapse;
        }

        .members-table th,
        .members-table td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .members-table th {
            background: var(--light-gray);
            font-weight: 600;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        .member-row {
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .member-row:hover {
            background: rgba(46, 204, 113, 0.05);
        }

        .sortable {
            cursor: pointer;
            user-select: none;
        }

        .sortable:hover {
            background: rgba(46, 204, 113, 0.1);
        }

        /* 회원 정보 표시 스타일 */
        .member-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .member-info small {
            color: var(--secondary-color);
            font-size: 0.8rem;
        }

        /* ===================================
           권한 배지 스타일
           =================================== */
        .role-badge {
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        /* 권한별 색상 적용 */
        .role-badge.seedling {
            background: rgba(139, 195, 74, 0.1);
            color: var(--role-seedling);
            border: 1px solid rgba(139, 195, 74, 0.3);
        }

        .role-badge.regular {
            background: rgba(33, 150, 243, 0.1);
            color: var(--role-regular);
            border: 1px solid rgba(33, 150, 243, 0.3);
        }

        .role-badge.excellent {
            background: rgba(156, 39, 176, 0.1);
            color: var(--role-excellent);
            border: 1px solid rgba(156, 39, 176, 0.3);
        }

        .role-badge.vip {
            background: rgba(255, 152, 0, 0.1);
            color: var(--role-vip);
            border: 1px solid rgba(255, 152, 0, 0.3);
        }

        /* 아이콘 추가 */
        .role-badge.seedling::before { content: '🌱'; }
        .role-badge.regular::before { content: '🌿'; }
        .role-badge.excellent::before { content: '🌳'; }
        .role-badge.vip::before { content: '👑'; }

        /* ===================================
           상태 배지 스타일
           =================================== */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
        }

        .status-badge.active {
            background: rgba(39, 174, 96, 0.1);
            color: var(--status-active);
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .status-badge.inactive {
            background: rgba(149, 165, 166, 0.1);
            color: var(--status-inactive);
            border: 1px solid rgba(149, 165, 166, 0.3);
        }

        .status-badge.suspended {
            background: rgba(231, 76, 60, 0.1);
            color: var(--status-suspended);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .type-badge {
            background: var(--warning-color);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .points {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* 액션 버튼 스타일 */
        .action-btns {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .action-btn.view {
            background: var(--info-color);
            color: white;
        }

        .action-btn.view:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }

        /* ===================================
           페이지네이션 스타일
           =================================== */
        .pagination-container {
            padding: 20px;
            display: flex;
            justify-content: center;
            background: var(--light-gray);
            border-top: 1px solid var(--border-color);
        }

        .pagination {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .page-link,
        .page-btn {
            padding: 10px 15px;
            text-decoration: none;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-color);
            background: white;
            transition: all 0.2s;
            cursor: pointer;
        }

        .page-link:hover,
        .page-btn:hover:not(.disabled) {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-1px);
        }

        .page-link.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .page-btn.disabled {
            background: var(--light-gray);
            color: var(--secondary-color);
            cursor: not-allowed;
            border-color: var(--border-color);
        }

        /* ===================================
           모달 기본 스타일
           =================================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-container {
            background: white;
            border-radius: 12px;
            box-shadow: var(--modal-shadow);
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: modalSlideIn 0.3s ease-out;
        }

        /* 권한 수정 모달은 작은 크기 */
        .modal-container.role-modal {
            max-width: 700px;
            max-height: 80vh;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid var(--border-color);
            background: var(--light-gray);
        }

        .modal-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary-color);
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--border-color);
            color: var(--text-color);
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 0;
        }

        /* ===================================
           회원 프로필 스타일 (모달 내)
           =================================== */
        .member-profile {
            display: flex;
            align-items: center;
            gap: 25px;
            padding: 25px;
            border-bottom: 1px solid var(--border-color);
            background: white;
        }

        .member-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--hover-color));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
            flex-shrink: 0;
        }

        .member-basic-info {
            flex: 1;
        }

        /* 회원 이름과 권한 수정 버튼을 함께 배치 */
        .member-name-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .member-basic-info h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin: 0;
        }

        .member-basic-info p {
            color: var(--secondary-color);
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .member-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* ===================================
           권한 수정 버튼 스타일
           =================================== */
        .btn-role-edit {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 20px;
            color: var(--primary-color);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-role-edit:hover {
            background: rgba(46, 204, 113, 0.2);
            border-color: var(--primary-color);
            transform: translateY(-1px);
        }

        .btn-role-edit .edit-icon {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .member-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex-shrink: 0;
        }

        .member-actions .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            font-weight: 500;
            text-align: center;
            min-width: 140px;
        }

        .btn-edit {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-edit:hover {
            background-color: var(--hover-color);
            transform: translateY(-1px);
        }

        .btn-message {
            background-color: var(--info-color);
            color: white;
        }

        .btn-message:hover {
            background-color: #2980b9;
            transform: translateY(-1px);
        }

        .btn-suspend {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-suspend:hover {
            background-color: #c0392b;
            transform: translateY(-1px);
        }

        /* ===================================
           모달 탭 스타일
           =================================== */
        .modal-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            background: var(--light-gray);
            overflow-x: auto;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 0.95rem;
            color: var(--secondary-color);
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            font-weight: 500;
            flex: 1;
            min-width: 120px;
            white-space: nowrap;
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: white;
            font-weight: 600;
        }

        .tab-btn:hover:not(.active) {
            color: var(--primary-color);
            background: rgba(46, 204, 113, 0.05);
        }

        /* ===================================
           탭 컨텐츠 스타일
           =================================== */
        .tab-content {
            min-height: 300px;
        }

        .tab-panel {
            display: none;
            padding: 25px;
            background: white;
        }

        .tab-panel.active {
            display: block;
        }

        /* ===================================
           정보 그리드 스타일
           =================================== */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-grid .info-item:nth-child(7) {
            grid-column: 1 / -1;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .info-item label {
            font-weight: 600;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        .info-item span {
            color: var(--text-color);
            padding: 12px 15px;
            background: var(--light-gray);
            border-radius: 6px;
            border: 2px solid transparent;
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        /* ===================================
           편집 모드 폼 스타일
           =================================== */
        .edit-mode {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s;
            background: white;
            min-height: 44px;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.1);
        }

        .form-input[readonly] {
            background: var(--light-gray);
            color: var(--secondary-color);
            cursor: not-allowed;
        }

        .form-select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px;
            padding-right: 45px;
        }

        /* ===================================
           위험 구역 스타일
           =================================== */
        .danger-zone {
            margin-top: 30px;
            padding: 20px;
            border: 2px solid var(--danger-color);
            border-radius: 8px;
            background: rgba(231, 76, 60, 0.05);
        }

        .danger-zone h4 {
            color: var(--danger-color);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .danger-warning {
            color: var(--danger-color);
            font-weight: 500;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .btn-danger-zone {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-danger-zone:hover {
            background: #c0392b;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }

        .danger-description {
            color: var(--secondary-color);
            font-size: 0.85rem;
            line-height: 1.4;
            margin: 0;
        }

        /* ===================================
           권한 수정 모달 전용 스타일
           =================================== */
        .role-edit-section {
            padding: 25px;
        }

        .current-member-info {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--light-gray);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .member-summary {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .member-avatar-small {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--hover-color));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            box-shadow: 0 2px 8px rgba(46, 204, 113, 0.3);
        }

        .member-details h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 4px;
        }

        .member-details p {
            color: var(--secondary-color);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .current-role {
            font-size: 0.85rem;
            color: var(--text-color);
        }

        .current-role span {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* 권한 선택 영역 */
        .role-selection {
            margin-bottom: 30px;
        }

        .role-selection h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 20px;
        }

        .role-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .role-option {
            cursor: pointer;
            transition: transform 0.2s;
        }

        .role-option:hover {
            transform: translateY(-2px);
        }

        .role-option.selected .role-card {
            border-color: var(--primary-color);
            background: rgba(46, 204, 113, 0.05);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.2);
        }

        .role-card {
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            background: white;
            transition: all 0.2s;
            height: 100%;
        }

        .role-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        }

        .role-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .role-info h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 5px;
        }

        .role-info p {
            color: var(--secondary-color);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .role-benefits {
            list-style: none;
            padding: 0;
        }

        .role-benefits li {
            position: relative;
            padding-left: 20px;
            margin-bottom: 5px;
            font-size: 0.85rem;
            color: var(--text-color);
        }

        .role-benefits li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--success-color);
            font-weight: bold;
        }

        /* 권한 변경 사유 */
        .role-reason {
            margin-bottom: 20px;
        }

        .role-reason h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 15px;
        }

        /* ===================================
           활동 내역 스타일
           =================================== */
        .activity-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .activity-stat {
            text-align: center;
            padding: 20px;
            background: var(--light-gray);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .activity-stat .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .activity-stat .stat-label {
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .activity-timeline h4 {
            margin-bottom: 15px;
            color: var(--dark-gray);
            font-weight: 600;
        }

        .timeline-list {
            border-left: 2px solid var(--border-color);
            padding-left: 20px;
        }

        .timeline-item {
            margin-bottom: 15px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -26px;
            top: 8px;
            width: 8px;
            height: 8px;
            background: var(--primary-color);
            border-radius: 50%;
        }

        .timeline-date {
            font-size: 0.85rem;
            color: var(--secondary-color);
            margin-bottom: 4px;
        }

        .timeline-content {
            color: var(--text-color);
            font-weight: 500;
        }

        /* ===================================
           거래 및 포인트 내역 스타일
           =================================== */
        .transaction-summary,
        .points-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .summary-item,
        .points-current,
        .points-total,
        .points-used {
            background: var(--light-gray);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .summary-label,
        .points-label {
            display: block;
            color: var(--secondary-color);
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .summary-value,
        .points-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        /* ===================================
           고객 지원 스타일
           =================================== */
        .support-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .support-stat {
            background: var(--light-gray);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .support-stat .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--info-color);
            margin-bottom: 8px;
        }

        .support-stat .stat-label {
            color: var(--secondary-color);
            font-size: 0.9rem;
        }

        /* ===================================
           모달 푸터 스타일
           =================================== */
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding: 20px 25px;
            border-top: 1px solid var(--border-color);
            background: var(--light-gray);
        }

        .modal-footer .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            min-width: 100px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--hover-color);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
            transform: translateY(-1px);
        }

        /* ===================================
           알림 메시지 스타일
           =================================== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 10001;
            max-width: 300px;
            box-shadow: var(--modal-shadow);
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.error {
            background: var(--danger-color);
        }

        .notification.warning {
            background: var(--warning-color);
        }

        .notification.info {
            background: var(--info-color);
        }

        /* ===================================
           반응형 디자인
           =================================== */
        @media (max-width: 1024px) {
            .admin-main {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }
            
            .sidebar-menu .menu-group ul {
                display: flex;
                gap: 10px;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .sidebar-menu .menu-group ul li {
                flex-shrink: 0;
                margin-bottom: 0;
            }
        }

        @media (max-width: 768px) {
            .admin-nav-container {
                flex-direction: column;
                height: auto;
                padding: 15px 0;
                gap: 15px;
            }
            
            .admin-nav-menu {
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }
            
            .admin-content {
                padding: 20px 15px;
            }
            
            .stats-cards {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .member-profile {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .member-name-section {
                justify-content: center;
            }
            
            .member-actions {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-tabs {
                flex-wrap: wrap;
            }
            
            .tab-btn {
                flex: 1;
                min-width: 100px;
            }
            
            .modal-container {
                width: 95%;
                margin: 20px;
            }
            
            .filter-options {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .filter-options select {
                width: 100%;
            }
            
            .role-options {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .page-header h1 {
                font-size: 1.5rem;
            }
            
            .stat-card {
                padding: 20px;
                gap: 15px;
            }
            
            .stat-icon {
                font-size: 2rem;
                width: 50px;
                height: 50px;
            }
            
            .stat-number {
                font-size: 1.5rem;
            }
            
            .search-filter-section {
                padding: 20px;
            }
            
            .modal-header {
                padding: 15px 20px;
            }
            
            .tab-panel {
                padding: 20px 15px;
            }
            
            .member-avatar {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .role-edit-section {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <!-- ========================================
         관리자 헤더 네비게이션
    ======================================== -->
    <header class="admin-header">
        <nav class="admin-navbar">
            <div class="admin-nav-container">
                <!-- 관리자 로고 -->
                <div class="admin-logo">
                    <span class="logo-icon">🌱</span>
                    <span class="logo-text">GreenCycle</span>
                    <span class="admin-badge">ADMIN</span>
                </div>
                
                <!-- 관리자 메뉴 -->
                <ul class="admin-nav-menu">
                    <li><a href="#dashboard">대시보드</a></li>
                    <li><a href="#members" class="active">회원 관리</a></li>
                    <li><a href="#services">서비스 관리</a></li>
                    <li><a href="#statistics">통계 관리</a></li>
                    <li><a href="#settings">설정</a></li>
                </ul>
                
                <!-- 관리자 프로필 -->
                <div class="admin-profile">
                    <span class="admin-name">관리자님</span>
                    <div class="admin-avatar">👨‍💼</div>
                    <button type="button" class="logout-btn">로그아웃</button>
                </div>
            </div>
        </nav>
    </header>

    <!-- ========================================
         메인 관리자 컨텐츠
    ======================================== -->
    <main class="admin-main">
        <!-- 사이드바 -->
        <aside class="admin-sidebar">
            <div class="sidebar-menu">
                <div class="menu-group">
                    <h3>회원 관리</h3>
                    <ul>
                        <li><a href="#all-members" class="active">전체 회원</a></li>
                        <li><a href="#new-members">신규 회원</a></li>
                        <li><a href="#active-members">활성 회원</a></li>
                        <li><a href="#inactive-members">비활성 회원</a></li>
                    </ul>
                </div>
            </div>
        </aside>

        <!-- 메인 콘텐츠 영역 -->
        <div class="admin-content">
            <!-- 페이지 헤더 -->
            <div class="page-header">
                <h1>회원 관리</h1>
            </div>

            <!-- 회원 통계 카드 -->
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon">👥</div>
                    <div class="stat-info">
                        <div class="stat-number">15,247</div>
                        <div class="stat-label">전체 회원</div>
                        <div class="stat-change positive">+12.5%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🆕</div>
                    <div class="stat-info">
                        <div class="stat-number">1,234</div>
                        <div class="stat-label">신규 회원 (이번 달)</div>
                        <div class="stat-change positive">+8.7%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⚡</div>
                    <div class="stat-info">
                        <div class="stat-number">8,956</div>
                        <div class="stat-label">활성 회원</div>
                        <div class="stat-change positive">+5.2%</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">💰</div>
                    <div class="stat-info">
                        <div class="stat-number">₩2,847,392</div>
                        <div class="stat-label">총 거래액</div>
                        <div class="stat-change positive">+15.3%</div>
                    </div>
                </div>
            </div>

            <!-- 검색 및 필터 영역 -->
            <div class="search-filter-section">
                <form id="searchForm">
                    <div class="search-box">
                        <input type="text" id="memberSearch" name="search" placeholder="회원명, 이메일, 닉네임으로 검색...">
                        <button type="submit" class="search-btn">🔍</button>
                    </div>
                    <div class="filter-options">
                        <!-- 회원 구분 필터 -->
                        <select id="typeFilter" name="type">
                            <option value="">회원 구분</option>
                            <option value="individual">개인</option>
                            <option value="business">기업</option>
                            <option value="organization">단체</option>
                        </select>
                        
                        <!-- 권한 등급 필터 -->
                        <select id="roleFilter" name="role">
                            <option value="">권한 등급</option>
                            <option value="SEEDLING">새싹</option>
                            <option value="REGULAR">일반회원</option>
                            <option value="EXCELLENT">우수회원</option>
                            <option value="VIP">VIP회원</option>
                        </select>
                        
                        <!-- 상태 필터 -->
                        <select id="statusFilter" name="status">
                            <option value="">전체 상태</option>
                            <option value="active">활성</option>
                            <option value="inactive">비활성</option>
                            <option value="suspended">정지</option>
                        </select>
                        
                        <a href="#" class="filter-reset">🔄 초기화</a>
                    </div>
                </form>
            </div>

            <!-- 회원 목록 테이블 -->
            <div class="table-container">
                <div class="table-header">
                    <h2>회원 목록</h2>
                    <div class="table-controls">
                        <select name="size" id="pageSize">
                            <option value="10">10개씩 보기</option>
                            <option value="25" selected>25개씩 보기</option>
                            <option value="50">50개씩 보기</option>
                            <option value="100">100개씩 보기</option>
                        </select>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="members-table" id="membersTable">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAll"></th>
                                <th class="sortable" data-sort="id">회원ID</th>
                                <th class="sortable" data-sort="name">이름/닉네임</th>
                                <th class="sortable" data-sort="email">이메일</th>
                                <th class="sortable" data-sort="role">권한등급</th>
                                <th class="sortable" data-sort="joinDate">가입일</th>
                                <th>상태</th>
                                <th>포인트</th>
                                <th>관리</th>
                            </tr>
                        </thead>
                        <tbody id="membersTableBody">
                            <!-- 샘플 회원 데이터 1 -->
                            <tr class="member-row" onclick="openMemberModal('M0000001')" data-member-id="M0000001">
                                <td><input type="checkbox" class="member-checkbox" value="M0000001" onclick="event.stopPropagation()"></td>
                                <td>M0000001</td>
                                <td>
                                    <div class="member-info">
                                        <span>안영이</span>
                                        <small>(환경지킴이)</small>
                                    </div>
                                </td>
                                <td>anyoung@example.com</td>
                                <td><span class="role-badge seedling">새싹</span></td>
                                <td>2024-01-15</td>
                                <td><span class="status-badge active">활성</span></td>
                                <td class="points">15,420P</td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn view" onclick="event.stopPropagation(); openMemberModal('M0000001')">상세보기</button>
                                    </div>
                                </td>
                            </tr>
                            <!-- 샘플 회원 데이터 2 -->
                            <tr class="member-row" onclick="openMemberModal('M0000002')" data-member-id="M0000002">
                                <td><input type="checkbox" class="member-checkbox" value="M0000002" onclick="event.stopPropagation()"></td>
                                <td>M0000002</td>
                                <td>
                                    <div class="member-info">
                                        <span>김환경</span>
                                        <small>(그린라이프)</small>
                                    </div>
                                </td>
                                <td>green@example.com</td>
                                <td><span class="role-badge regular">일반회원</span></td>
                                <td>2024-02-20</td>
                                <td><span class="status-badge active">활성</span></td>
                                <td class="points">8,750P</td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn view" onclick="event.stopPropagation(); openMemberModal('M0000002')">상세보기</button>
                                    </div>
                                </td>
                            </tr>
                            <!-- 샘플 회원 데이터 3 -->
                            <tr class="member-row" onclick="openMemberModal('M0000003')" data-member-id="M0000003">
                                <td><input type="checkbox" class="member-checkbox" value="M0000003" onclick="event.stopPropagation()"></td>
                                <td>M0000003</td>
                                <td>
                                    <div class="member-info">
                                        <span>박재활</span>
                                        <small>(재활용왕)</small>
                                    </div>
                                </td>
                                <td>recycle@example.com</td>
                                <td><span class="role-badge excellent">우수회원</span></td>
                                <td>2024-03-10</td>
                                <td><span class="status-badge active">활성</span></td>
                                <td class="points">22,300P</td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn view" onclick="event.stopPropagation(); openMemberModal('M0000003')">상세보기</button>
                                    </div>
                                </td>
                            </tr>
                            <!-- 샘플 회원 데이터 4 -->
                            <tr class="member-row" onclick="openMemberModal('M0000004')" data-member-id="M0000004">
                                <td><input type="checkbox" class="member-checkbox" value="M0000004" onclick="event.stopPropagation()"></td>
                                <td>M0000004</td>
                                <td>
                                    <div class="member-info">
                                        <span>최지구</span>
                                        <small>(에코마스터)</small>
                                    </div>
                                </td>
                                <td>eco@example.com</td>
                                <td><span class="role-badge vip">VIP회원</span></td>
                                <td>2024-01-05</td>
                                <td><span class="status-badge active">활성</span></td>
                                <td class="points">45,800P</td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn view" onclick="event.stopPropagation(); openMemberModal('M0000004')">상세보기</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 페이지네이션 -->
                <div class="pagination-container">
                    <div class="pagination" id="pagination">
                        <span class="page-btn disabled">◀ 이전</span>
                        <a href="#" class="page-link active">1</a>
                        <a href="#" class="page-link">2</a>
                        <a href="#" class="page-link">3</a>
                        <a href="#" class="page-btn">다음 ▶</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ========================================
         회원 상세 정보 모달
    ======================================== -->
    <div class="modal-overlay" id="memberModal">
        <div class="modal-container">
            <!-- 모달 헤더 -->
            <div class="modal-header">
                <h2>회원 상세 정보</h2>
                <button class="modal-close" id="closeModal">✕</button>
            </div>
            
            <div class="modal-body">
                <!-- 회원 기본 정보 섹션 -->
                <div class="member-info-section">
                    <!-- 회원 프로필 영역 -->
                    <div class="member-profile">
                        <div class="member-avatar" id="memberAvatar">👤</div>
                        <div class="member-basic-info">
                            <div class="member-name-section">
                                <h3 id="memberName">안영이</h3>
                                <!-- 권한 수정 버튼 추가 -->
                                <button class="btn-role-edit" onclick="openRoleModal()" title="권한 등급 수정">
                                    <span id="memberRoleDisplay">새싹</span>
                                    <span class="edit-icon">✏️</span>
                                </button>
                            </div>
                            <p id="memberEmail">anyoung@example.com</p>
                            <div class="member-badges">
                                <span class="status-badge active" id="memberStatus">활성</span>
                                <span class="type-badge" id="memberType">개인</span>
                            </div>
                        </div>
                        <!-- 회원 액션 버튼들 -->
                        <div class="member-actions">
                            <button class="btn btn-edit" onclick="toggleEditMode()">✏️ 정보 수정</button>
                            <button class="btn btn-message" onclick="sendMessageToMember()">💬 메시지 발송</button>
                            <button class="btn btn-suspend" onclick="suspendCurrentMember()">⚠️ 계정 정지</button>
                        </div>
                    </div>

                    <!-- 상세 정보 탭 네비게이션 -->
                    <div class="modal-tabs">
                        <button class="tab-btn active" data-tab="basic">기본 정보</button>
                        <button class="tab-btn" data-tab="activity">활동 내역</button>
                        <button class="tab-btn" data-tab="transactions">거래 내역</button>
                        <button class="tab-btn" data-tab="points">포인트 내역</button>
                        <button class="tab-btn" data-tab="support">고객 지원</button>
                    </div>

                    <!-- 탭 컨텐츠 영역 -->
                    <div class="tab-content">
                        <!-- 기본 정보 탭 - 읽기 모드 -->
                        <div class="tab-panel active" id="basicTab">
                            <!-- 읽기 모드 -->
                            <div class="info-grid" id="readOnlyInfo">
                                <div class="info-item">
                                    <label>회원 ID</label>
                                    <span id="detailMemberId">M0000001</span>
                                </div>
                                <div class="info-item">
                                    <label>닉네임</label>
                                    <span id="detailNickname">환경지킴이</span>
                                </div>
                                <div class="info-item">
                                    <label>생년월일</label>
                                    <span id="detailBirthdate">1995년</span>
                                </div>
                                <div class="info-item">
                                    <label>성별</label>
                                    <span id="detailGender">여성</span>
                                </div>
                                <div class="info-item">
                                    <label>주소</label>
                                    <span id="detailAddress">서울</span>
                                </div>
                                <div class="info-item">
                                    <label>가입일</label>
                                    <span id="detailJoinDate">2024-01-15</span>
                                </div>
                                <div class="info-item">
                                    <label>최근 방문</label>
                                    <span id="detailLastVisit">2024-07-25 14:30</span>
                                </div>
                            </div>

                            <!-- 편집 모드 -->
                            <div class="info-grid edit-mode" id="editableInfo" style="display: none;">
                                <div class="info-item">
                                    <label>회원 ID</label>
                                    <input type="text" id="editMemberId" class="form-input" readonly>
                                </div>
                                <div class="info-item">
                                    <label>닉네임 *</label>
                                    <input type="text" id="editNickname" class="form-input" placeholder="닉네임을 입력하세요">
                                </div>
                                <div class="info-item">
                                    <label>생년월일</label>
                                    <select id="editBirthdate" class="form-select">
                                        <option value="">선택</option>
                                        <!-- 년도 옵션은 JavaScript에서 동적 생성 -->
                                    </select>
                                </div>
                                <div class="info-item">
                                    <label>성별</label>
                                    <select id="editGender" class="form-select">
                                        <option value="">선택</option>
                                        <option value="male">남성</option>
                                        <option value="female">여성</option>
                                        <option value="other">기타</option>
                                    </select>
                                </div>
                                <div class="info-item">
                                    <label>주소</label>
                                    <select id="editAddress" class="form-select">
                                        <option value="">선택</option>
                                        <option value="seoul">서울</option>
                                        <option value="busan">부산</option>
                                        <option value="daegu">대구</option>
                                        <option value="incheon">인천</option>
                                        <option value="gwangju">광주</option>
                                        <option value="daejeon">대전</option>
                                        <option value="ulsan">울산</option>
                                    </select>
                                </div>
                                <div class="info-item">
                                    <label>가입일</label>
                                    <input type="text" id="editJoinDate" class="form-input" readonly>
                                </div>
                                <div class="info-item">
                                    <label>최근 방문</label>
                                    <input type="text" id="editLastVisit" class="form-input" readonly>
                                </div>
                            </div>

                            <!-- 편집 모드 시 표시되는 위험 구역 -->
                            <div class="danger-zone" id="dangerZone" style="display: none;">
                                <h4>⚠️ 위험한 작업</h4>
                                <p class="danger-warning">
                                    아래 작업은 되돌릴 수 없습니다. 신중하게 결정해 주세요.
                                </p>
                                <button class="btn btn-danger-zone" onclick="deleteCurrentMember()">
                                    🗑️ 회원 계정 완전 삭제
                                </button>
                                <p class="danger-description">
                                    회원 계정을 완전히 삭제합니다. 모든 데이터가 영구적으로 삭제되며 복구할 수 없습니다.<br>
                                    삭제 시 회원의 모든 활동 내역, 포인트, 거래 정보가 함께 삭제됩니다.
                                </p>
                            </div>
                        </div>

                        <!-- 활동 내역 탭 -->
                        <div class="tab-panel" id="activityTab">
                            <div class="activity-stats">
                                <div class="activity-stat">
                                    <div class="stat-number" id="wasteClassifications">127</div>
                                    <div class="stat-label">분리배출 횟수</div>
                                </div>
                                <div class="activity-stat">
                                    <div class="stat-number" id="sharingParticipations">43</div>
                                    <div class="stat-label">무료나눔 참여</div>
                                </div>
                                <div class="activity-stat">
                                    <div class="stat-number" id="ecoMarketPurchases">28</div>
                                    <div class="stat-label">에코마켓 구매</div>
                                </div>
                                <div class="activity-stat">
                                    <div class="stat-number" id="communityActivities">156</div>
                                    <div class="stat-label">커뮤니티 활동</div>
                                </div>
                            </div>
                            <div class="activity-timeline">
                                <h4>최근 활동</h4>
                                <div class="timeline-list" id="activityTimeline">
                                    <div class="timeline-item">
                                        <div class="timeline-date">2024-07-25</div>
                                        <div class="timeline-content">플라스틱 분리배출 완료 (+50P)</div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-date">2024-07-24</div>
                                        <div class="timeline-content">에코마켓에서 친환경 세제 구매</div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-date">2024-07-23</div>
                                        <div class="timeline-content">무료나눔 글 등록 (+30P)</div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-date">2024-07-22</div>
                                        <div class="timeline-content">커뮤니티 댓글 작성 (+10P)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 거래 내역 탭 -->
                        <div class="tab-panel" id="transactionsTab">
                            <div class="transaction-summary">
                                <div class="summary-item">
                                    <span class="summary-label">총 구매액</span>
                                    <span class="summary-value" id="totalPurchaseAmount">₩847,300</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">총 주문 건수</span>
                                    <span class="summary-value" id="totalOrderCount">47건</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">평균 주문액</span>
                                    <span class="summary-value" id="averageOrderAmount">₩18,028</span>
                                </div>
                            </div>
                        </div>

                        <!-- 포인트 내역 탭 -->
                        <div class="tab-panel" id="pointsTab">
                            <div class="points-summary">
                                <div class="points-current">
                                    <span class="points-label">보유 포인트</span>
                                    <span class="points-value" id="currentPoints">15,420P</span>
                                </div>
                                <div class="points-total">
                                    <span class="points-label">누적 적립 포인트</span>
                                    <span class="points-value" id="totalPoints">127,850P</span>
                                </div>
                                <div class="points-used">
                                    <span class="points-label">사용한 포인트</span>
                                    <span class="points-value" id="usedPoints">112,430P</span>
                                </div>
                            </div>
                        </div>

                        <!-- 고객 지원 탭 -->
                        <div class="tab-panel" id="supportTab">
                            <div class="support-summary">
                                <div class="support-stat">
                                    <span class="stat-number" id="totalInquiries">3</span>
                                    <span class="stat-label">총 문의 건수</span>
                                </div>
                                <div class="support-stat">
                                    <span class="stat-number" id="completedInquiries">2</span>
                                    <span class="stat-label">처리 완료</span>
                                </div>
                                <div class="support-stat">
                                    <span class="stat-number" id="processingInquiries">1</span>
                                    <span class="stat-label">처리 중</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 모달 푸터 -->
            <div class="modal-footer" id="modalFooter">
                <button class="btn btn-secondary" id="cancelBtn" onclick="closeModal()">취소</button>
                <button class="btn btn-primary" id="saveBtn" onclick="saveCurrentMember()" style="display: none;">변경사항 저장</button>
            </div>
        </div>
    </div>

    <!-- ========================================
         권한 수정 모달
    ======================================== -->
    <div class="modal-overlay" id="roleModal">
        <div class="modal-container role-modal">
            <!-- 모달 헤더 -->
            <div class="modal-header">
                <h2>권한 등급 수정</h2>
                <button class="modal-close" onclick="closeRoleModal()">✕</button>
            </div>
            
            <div class="modal-body">
                <div class="role-edit-section">
                    <!-- 현재 회원 정보 -->
                    <div class="current-member-info">
                        <div class="member-summary">
                            <div class="member-avatar-small">👤</div>
                            <div class="member-details">
                                <h4 id="roleMemberName">안영이</h4>
                                <p id="roleMemberEmail">anyoung@example.com</p>
                                <span class="current-role">현재 등급: <span id="currentRoleDisplay">새싹</span></span>
                            </div>
                        </div>
                    </div>

                    <!-- 권한 등급 선택 -->
                    <div class="role-selection">
                        <h3>새로운 권한 등급 선택</h3>
                        <div class="role-options">
                            <!-- 새싹 등급 -->
                            <div class="role-option" data-role="SEEDLING">
                                <div class="role-card">
                                    <div class="role-icon">🌱</div>
                                    <div class="role-info">
                                        <h4>새싹</h4>
                                        <p>신규 가입 회원</p>
                                        <ul class="role-benefits">
                                            <li>기본 서비스 이용</li>
                                            <li>포인트 적립 5%</li>
                                            <li>월 3회 무료나눔 참여</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 일반회원 등급 -->
                            <div class="role-option" data-role="REGULAR">
                                <div class="role-card">
                                    <div class="role-icon">🌿</div>
                                    <div class="role-info">
                                        <h4>일반회원</h4>
                                        <p>활동이 활발한 회원</p>
                                        <ul class="role-benefits">
                                            <li>모든 서비스 이용</li>
                                            <li>포인트 적립 7%</li>
                                            <li>무제한 무료나눔 참여</li>
                                            <li>할인 쿠폰 제공</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 우수회원 등급 -->
                            <div class="role-option" data-role="EXCELLENT">
                                <div class="role-card">
                                    <div class="role-icon">🌳</div>
                                    <div class="role-info">
                                        <h4>우수회원</h4>
                                        <p>환경 보호에 기여하는 회원</p>
                                        <ul class="role-benefits">
                                            <li>프리미엄 서비스 이용</li>
                                            <li>포인트 적립 10%</li>
                                            <li>우선 배송 서비스</li>
                                            <li>전용 고객센터</li>
                                            <li>특별 이벤트 초대</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- VIP회원 등급 -->
                            <div class="role-option" data-role="VIP">
                                <div class="role-card">
                                    <div class="role-icon">👑</div>
                                    <div class="role-info">
                                        <h4>VIP회원</h4>
                                        <p>최상위 등급 회원</p>
                                        <ul class="role-benefits">
                                            <li>모든 프리미엄 혜택</li>
                                            <li>포인트 적립 15%</li>
                                            <li>무료 배송 (무제한)</li>
                                            <li>전담 매니저 배정</li>
                                            <li>연간 특별 선물</li>
                                            <li>신제품 우선 체험</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 권한 변경 사유 -->
                    <div class="role-reason">
                        <h3>권한 변경 사유</h3>
                        <textarea id="roleChangeReason" class="form-textarea" 
                                  placeholder="권한 변경 사유를 입력하세요... (선택사항)" 
                                  rows="3"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- 모달 푸터 -->
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRoleModal()">취소</button>
                <button class="btn btn-primary" onclick="saveRoleChange()">권한 변경</button>
            </div>
        </div>
    </div>

    <script>
        /**
         * ===================================
         * GreenCycle 관리자 회원 관리 시스템
         * JavaScript 메인 파일 (VS Code 실행용)
         * ===================================
         */

        // ===================================
        // 전역 변수 및 상태 관리
        // ===================================

        let isEditMode = false; // 편집 모드 상태
        let originalData = {}; // 원본 데이터 백업용
        let currentMemberId = null; // 현재 선택된 회원 ID
        let selectedRole = null; // 권한 수정 모달에서 선택된 권한

        // 권한 등급 매핑 데이터
        const ROLE_MAPPING = {
            'SEEDLING': {
                displayName: '새싹',
                icon: '🌱',
                color: '#8bc34a',
                description: '신규 가입 회원'
            },
            'REGULAR': {
                displayName: '일반회원',
                icon: '🌿',
                color: '#2196f3',
                description: '활동이 활발한 회원'
            },
            'EXCELLENT': {
                displayName: '우수회원',
                icon: '🌳',
                color: '#9c27b0',
                description: '환경 보호에 기여하는 회원'
            },
            'VIP': {
                displayName: 'VIP회원',
                icon: '👑',
                color: '#ff9800',
                description: '최상위 등급 회원'
            }
        };

        // 상태 매핑 데이터
        const STATUS_MAPPING = {
            'active': {
                displayName: '활성',
                color: '#27ae60'
            },
            'inactive': {
                displayName: '비활성',
                color: '#95a5a6'
            },
            'suspended': {
                displayName: '정지',
                color: '#e74c3c'
            }
        };

        // 샘플 회원 데이터 (VS Code 실행용)
        const sampleMemberData = {
            'M0000001': {
                memberId: 'M0000001',
                name: '안영이',
                email: 'anyoung@example.com',
                nickname: '환경지킴이',
                role: 'SEEDLING',
                status: 'active',
                type: 'individual',
                birthdate: '1995',
                gender: 'female',
                address: 'seoul',
                joinDate: '2024-01-15',
                lastVisit: '2024-07-25 14:30',
                points: 15420,
                activities: {
                    wasteClassifications: 127,
                    sharingParticipations: 43,
                    ecoMarketPurchases: 28,
                    communityActivities: 156
                },
                transactions: {
                    totalPurchaseAmount: 847300,
                    totalOrderCount: 47,
                    averageOrderAmount: 18028
                },
                pointsInfo: {
                    currentPoints: 15420,
                    totalPoints: 127850,
                    usedPoints: 112430
                },
                support: {
                    totalInquiries: 3,
                    completedInquiries: 2,
                    processingInquiries: 1
                }
            },
            'M0000002': {
                memberId: 'M0000002',
                name: '김환경',
                email: 'green@example.com',
                nickname: '그린라이프',
                role: 'REGULAR',
                status: 'active',
                type: 'individual',
                birthdate: '1988',
                gender: 'male',
                address: 'busan',
                joinDate: '2024-02-20',
                lastVisit: '2024-07-24 10:15',
                points: 8750,
                activities: {
                    wasteClassifications: 89,
                    sharingParticipations: 23,
                    ecoMarketPurchases: 15,
                    communityActivities: 94
                },
                transactions: {
                    totalPurchaseAmount: 542100,
                    totalOrderCount: 31,
                    averageOrderAmount: 17486
                },
                pointsInfo: {
                    currentPoints: 8750,
                    totalPoints: 89340,
                    usedPoints: 80590
                },
                support: {
                    totalInquiries: 1,
                    completedInquiries: 1,
                    processingInquiries: 0
                }
            },
            'M0000003': {
                memberId: 'M0000003',
                name: '박재활',
                email: 'recycle@example.com',
                nickname: '재활용왕',
                role: 'EXCELLENT',
                status: 'active',
                type: 'individual',
                birthdate: '1992',
                gender: 'male',
                address: 'daegu',
                joinDate: '2024-03-10',
                lastVisit: '2024-07-25 09:45',
                points: 22300,
                activities: {
                    wasteClassifications: 234,
                    sharingParticipations: 67,
                    ecoMarketPurchases: 45,
                    communityActivities: 189
                },
                transactions: {
                    totalPurchaseAmount: 1234500,
                    totalOrderCount: 78,
                    averageOrderAmount: 15827
                },
                pointsInfo: {
                    currentPoints: 22300,
                    totalPoints: 198750,
                    usedPoints: 176450
                },
                support: {
                    totalInquiries: 2,
                    completedInquiries: 2,
                    processingInquiries: 0
                }
            },
            'M0000004': {
                memberId: 'M0000004',
                name: '최지구',
                email: 'eco@example.com',
                nickname: '에코마스터',
                role: 'VIP',
                status: 'active',
                type: 'individual',
                birthdate: '1985',
                gender: 'male',
                address: 'seoul',
                joinDate: '2024-01-05',
                lastVisit: '2024-07-25 16:20',
                points: 45800,
                activities: {
                    wasteClassifications: 456,
                    sharingParticipations: 123,
                    ecoMarketPurchases: 89,
                    communityActivities: 321
                },
                transactions: {
                    totalPurchaseAmount: 2847500,
                    totalOrderCount: 156,
                    averageOrderAmount: 18254
                },
                pointsInfo: {
                    currentPoints: 45800,
                    totalPoints: 389200,
                    usedPoints: 343400
                },
                support: {
                    totalInquiries: 5,
                    completedInquiries: 4,
                    processingInquiries: 1
                }
            }
        };

        // ===================================
        // DOM 로드 완료 후 초기화
        // ===================================

        document.addEventListener('DOMContentLoaded', function() {
            console.log('🌱 GreenCycle 관리자 회원 관리 시스템 로드 완료');
            initializeAdminSystem();
            setupEventListeners();
            populateYearOptions();
            showWelcomeMessage();
        });

        // ===================================
        // 초기화 함수들
        // ===================================

        /**
         * 관리자 시스템 초기화
         */
        function initializeAdminSystem() {
            console.log('관리자 시스템 초기화 시작');
            
            try {
                // 체크박스 전체 선택 기능 초기화
                initializeSelectAll();
                
                // 검색 및 필터 기능 초기화
                initializeSearchAndFilters();
                
                // 페이지 크기 변경 기능 초기화
                initializePageSizeControl();
                
                // 테이블 정렬 기능 초기화
                initializeTableSorting();
                
                console.log('✅ 관리자 시스템 초기화 완료');
            } catch (error) {
                console.error('❌ 시스템 초기화 중 오류:', error);
                showNotification('시스템 초기화에 실패했습니다.', 'error');
            }
        }

        /**
         * 이벤트 리스너 설정
         */
        function setupEventListeners() {
            console.log('이벤트 리스너 설정 시작');
            
            try {
                // 모달 관련 이벤트
                setupModalEvents();
                
                // 키보드 단축키 이벤트
                setupKeyboardShortcuts();
                
                // 권한 수정 관련 이벤트
                setupRoleEditEvents();
                
                // 페이지 이탈 시 경고 (편집 모드일 때)
                setupPageUnloadWarning();
                
                console.log('✅ 이벤트 리스너 설정 완료');
            } catch (error) {
                console.error('❌ 이벤트 리스너 설정 중 오류:', error);
            }
        }

        /**
         * 모달 관련 이벤트 설정
         */
        function setupModalEvents() {
            // 회원 상세 모달 닫기 버튼
            const memberModalClose = document.getElementById('closeModal');
            if (memberModalClose) {
                memberModalClose.addEventListener('click', closeModal);
            }
            
            // 회원 상세 모달 외부 클릭으로 닫기
            const memberModal = document.getElementById('memberModal');
            if (memberModal) {